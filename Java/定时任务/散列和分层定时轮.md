#### 	  散列和分层定时轮：用于有效实现定时器设备的数据结构

					George Varghese and Tony Lauck 

##### 摘要

用于实现操作系统定时器模块的常规算法来启动或维持一个定时器的时间复杂度是0(n)，其中n是未完成定时器的数量(如果 n 非常大时，会消耗太多资源)。本文首先探讨了用于离散事件模拟和排序技术中的定时器算法与时间流机制之间的关系。然后，给出了用于小定时器间隔的定时器算法，其类似于逻辑模拟器中使用的定时轮技术。通过使用圆形缓冲器或定时轮，使得启动、停止和维护定时轮中的定时器的时间复杂度为 0(1)。

描述了用于较大间隔值的两个扩展。首先，定时器间隔被散列到定时轮上的槽中。其次，具有不同粒度的定时轮的层次结构用于跨越更大范围的间隔。讨论了这两种方案的性能和各种实现权衡。

##### 1 引言

在中心化或分布式系统中，我们需要使用定时器去做：

- 故障恢复：有些故障无法被异步的检测到。有些可以被定期的检测到（如，内存损坏），这样的定时器总是过期的。其他的故障只能在某个特定的时刻去做人工干预（如，信息确认）。如果故障很少见，这样定时器将很少过期
- 对于时间或相对时间控制的算法是比较全面的：例如，控制某个实体的生产速率的算法（过程控制、通信中基于速率的流量控制）、调度算法以及控制计算机网络中数据包生存时间的算法。这些计时器几乎总是过期。

当以下任一条件成立时，实现定时器模块的算法性能将成为一个问题：

- 如果该算法由一个每次硬件时钟都会被中断的处理器所实现，并且中断开销很大
- 需要精细粒度的定时器
- 未完成计时器的平均数量很大

例如，考虑分布式系统成员之间的通信。由于消息可能会在底层网络中丢失，因此在某种程度上需要计时器来触发重新传输。分布式系统中的主机可以有几个未完成的计时器。例如，考虑一个具有200个连接和3个计时器的服务器。此外，随着网络扩展到更高的速度（>100兆比特/秒），所需的解决方案和计时器的启动和停止速度都将增加。

如果每一个硬件时钟将会中断主机，时钟间隔是以微秒为单位的，那么中断开销是相当大的。大多数主机操作系统都提供粗粒度（毫秒或秒）的计时器。或者，在某些系统中，更精细的粒度计时器驻留在专用硬件中。在这两种情况下，定时器算法的性能将是一个问题。因为算法性能决定启动、停止定时器的延时时间，并且所有定时器可能同时未完成。

##### 2 模型和性能度量

